function SplitStringToChunks {
    <#
        .SYNOPSIS
        Splits a long string into chunks of random length.
    
        .DESCRIPTION
        InputString is split into chunks of random length.
        The length will be between fromNumber and toNumber.
    
        .PARAMETER InputString
        Your personal string (can be any kind of long string).
    
        .PARAMETER $fromNumber
        The minimum length of each chunk.
    
        .PARAMETER $toNumber
        The maximum length of each chunk.
    
        .EXAMPLE
        $DllBytes64 = "very long String In Base64"
        SplitStringToChunks -InputString $DllBytes64
    
        .NOTES
        Output is an array of string chunks.
    #>
    
        param (
            [Parameter(Mandatory=$true)]
            [string]$InputString,
    
            [Parameter(Mandatory=$false)]
            [int]$fromNumber = 222, # minimum chunk length
    
            [Parameter(Mandatory=$false)]
            [int]$toNumber = 555 # maximum chunk length
        )
    
        $stringLength = $InputString.Length
    
        # Initialize variables
        $chunks = @()
        $startIndex = 0
        $random = New-Object System.Random
    
        # Split the string into chunks with random lengths
        while ($startIndex -lt $stringLength) {
            $chunkLength = $random.Next($fromNumber, $toNumber)  # Random length between fromNumber and toNumber
            $endIndex = [math]::Min($startIndex + $chunkLength, $stringLength) - 1
            $chunks += $InputString.Substring($startIndex, $endIndex - $startIndex + 1)
            $startIndex = $endIndex + 1
        }
    
        return $chunks
    }
    
function JoinChunksToString {
<#
    .SYNOPSIS
    Joins an array of string chunks into a single string.

    .DESCRIPTION
    Joins an array of string chunks into a single string.

    .PARAMETER Chunks
    Array of string chunks to join.

    .EXAMPLE
    $chunks = @("chunk1", "chunk2", "chunk3")
    JoinChunksToString -Chunks $chunks

    .NOTES
    Output is a single concatenated string.
#>

    param (
        [Parameter(Mandatory=$true)]
        [string[]]$Chunks
    )

    # Join the chunks into a single string
    $joinedString = $Chunks -join ''

    return $joinedString
    }
